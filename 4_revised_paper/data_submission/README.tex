\documentclass[gmd,manuscript]{copernicus}
\usepackage{forest}
\usepackage{pdflscape}

\begin{document}

\title{Data for Idealized Particle-Resolved Large-Eddy Simulations to Evaluate the Impact of Emissions Spatial Heterogeneity on CCN Activity}

\Author[1]{Samuel}{Frederick}
\Author[2]{Matin}{Mohebalhojeh}
\Author[1,2]{Jeffrey}{Curtis}
\Author[2]{Matthew}{West}
\Author[1][nriemer@illinois.edu]{Nicole}{Riemer} %% correspondence author

\affil[1]{Department of Climate, Meteorology, and Atmospheric Sciences, University of Illinois Urbana--Champaign, 1301 W. Green St., Urbana, IL 61801, USA}
\affil[2]{Department of Mechanical Science and Engineering, University of Illinois Urbana--Champaign, 1206 W. Green St., Urbana, IL, 61801,USA}

\correspondence{Nicole Riemer (nriemer@illinois.edu)}

\runningtitle{Data for \textcolor{red}{Copy final name from paper}}

\runningauthor{Frederick et al.}

%% These dates will be inserted by Copernicus Publications during the typesetting process.


\firstpage{1}

\maketitle

This dataset contains all material required to produce the figures found within the manuscript submitted to Aerosol Chemistry and Physics entitled ``Idealized Particle-Resolved Large-Eddy Simulations to Evaluate the Impact of Emissions Spatial Heterogeneity on CCN Activity''. 
The archived dataset consists of:

\begin{itemize}
\item \texttt{data.zip}: WRF-PartMC-MOSIAC-LES simulation data in Section~3
\item \texttt{scripts.zip}: Python notebooks for generating figures in Section~2 and 3, and scripts used to compile the normalized spatial heterogeneity metric as described by Mohebalhojeh et al. 2026.
\end{itemize}

\section*{Software requirements/recommendations}

All figures in the paper were run with Python 3.9.23. This older version is required due to a dependency of \texttt{f2py} (used to compile Fortran code for the spatial heterogeneity metric calculation into an object which can be imported as a Python module) which has since been deprecated.  Users should run the \texttt{create\_env.sh} script in \texttt{scripts.zip} to create a conda environment which contains all the necessary packages.

Required packages are as follows with the version used for this manuscript:
\begin{itemize}
\item numpy (2.0.2)
\item scipy (1.13.1)
\item matplotlib (3.9.2)
\item netCDF4 (1.7.2) - available at \url{https://unidata.github.io/netcdf4-python/}
\item pandas (2.3.1)
\item ipykernel (6.30.1)
\item setuptools (59.8.0)
\item gfortran (15.1.0)
\end{itemize}


\section*{Directory structure of simulation data for Section 3}

Upon downloading and untarring \texttt{data.zip}, it may be explored as follows:

\begin{itemize}
    \item Data files containing a subset of variables, spatial dimensions, and time slices used in generating Section 3 figures. Slices 
    of the domain indicate the index along a given dimension (e.g., time ranges from 0 to 36, vertical height ranges from 0 to 99). Datasets 
    are organized by each emissions scenario (\texttt{no-heterogeneity}, \texttt{low-heterogeneity}, \texttt{medium-heterogeneity}, \texttt{high-heterogeneity}). 
    Rather than listing each file here, we replace the scenario title in filenames by \texttt{*}:
    \begin{itemize}
      \item Per-grid cell values for gas phase species, aerosol composition, and CCN concentration variables at $t=6$~h. Runs without ammonia (discussed in manuscript Section 3.6 contain the scenario followed by  \texttt{*-no-nh4-}). Datasets end in the following pattern: \newline \texttt{*\_subset\_t36.nc}
      \item Binned aerosol number and mass distributions: \newline \texttt{*\_size-dist\_subset\_t0\_t36\_z60.nc}
      \item CCN concentration variables, aerosol ammonium, nitrate, and sulfate, and gas phase ammonia and nitric acid, all averaged across each vertical level. The vertical average of each variable is contained at 10-minute increments from $t=0$~h to $t=6$~h. Runs with emissions turned off at $t=4$~h (discussed in Section 3.7) contain the scenario named followed by \texttt{*-emis-off-t4}. Scenarios with high RH (discussed in Section 3.8) contain the scenario named followed by \texttt{*-high-RH}. Datasets end in the following pattern: \newline \texttt{*\_time-height-avg\_subset.nc}
      \item Vertical profiles of environmental conditions (temperature, RH), output at 10-minute increments. At each time, quantities are averaged across each vertical level. This includes ``no heterogeneity'' and ``high heterogeneity'' scenarios at lower RH indicated in manuscript Figure 2 and higher RH scenarios  (labeled by scenario followed by \texttt{*-high-RH-}). Datasets end in the following pattern: \newline \texttt{*\_met-vars\_subset.nc}
      \item Detailed per-particle output (e.g., per-particle mass fractions, kappa); only including ``no heterogeneity'' and ``high heterogeneity'' scenarios: \newline \texttt{crosssec\_*\_t0\_z40.nc}, \newline \texttt{crosssec\_*\_t36\_z40.nc}
    \end{itemize}
    \item Data in the \texttt{spatial-het/} directory consists of lookup tables for spatial heterogeneity values and binary
    arrays indicating the structure of each emissions pattern:
	\begin{itemize}
	  \item Lookup table for the spatial heterogeneity value ($\eta$) of each emission pattern: \\
    \texttt{sh\_patterns\_xres100\_yres100\_exact.csv}
	  \item Arrays for each emission scenario: \texttt{/sh-patterns/xres100yres100/[scenario-name].csv}
	\end{itemize}
  \item This file was compressed on a computer running macOS. When decompressing this file on other operating systems, users may see an additional folder labeled \texttt{\_\_MACOSX}. This folder does not impact the use of datasets in this directory and can be safely ignored or removed.
\end{itemize}

\section*{Directory structure of scripts for Section 3}

Upon downloading and untarring \texttt{scripts.zip}, it may be explored as follows:

\begin{itemize}
  \item \texttt{create\_env.sh}: Shell script for setting up a \texttt{conda} environment with the particular version of Python and associated packages required. \textbf{Please run this script first before proceeding to run other files in this directory.}
  \item \texttt{compile\_nsh.sh}: Shell script for compiling \texttt{nsh.f90} to a Python executable object via the \texttt{f2py} package. Once this script runs, you should see a \text{*.so} shared object library file.
  \item \texttt{nsh.f90}: Fortran module for calculating the discrete normalized spatial heterogeneity metric of Mohebalhojeh et al. 2025. This module contains two subroutines, \texttt{normalizedSpatialHet()} which is naive looping routine over all subarray configurations. For large domain sizes, this routine is computationally prohibitive and the Monte Carlo sampling subroutine \texttt{monteCarloSpatialHet()} is preferred.
  \item \texttt{griddedoutput\_helperfuncs.py}: Helper functions for processing and plotting per-particle datasets.
  \item \texttt{griddedoutput\_plotting.py}: Plotting functions for per-particle datasets.
  \item \texttt{loaddatastructs.py}: Datasets and associated attributes are housed within the objects \texttt{DataStruct} and the inherited class \texttt{GriddedOutput} for per-particle datasets.
  \item \texttt{generate\_data\_subsets.sh}: Shell script for processing WRF-PartMC output files to the data subsets contained in the \texttt{data.zip} directory. 
  \item \texttt{paper-figures-bulk.ipynb}: Python notebook for generating Figures 1--7 and 10--15.  
  \item \texttt{paper-figures-particle-resolved.ipynb}: Python notebook for generating Figures 8,9 from per-particle datasets.
  \item This file was compressed on a computer running macOS. When decompressing this file on other operating systems, users may see an additional folder labeled \texttt{\_\_MACOSX}. This folder does not impact the use of scripts in this directory and can be safely ignored or removed. 
\end{itemize}

\end{document}